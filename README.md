# 115.бел API

Скрипты для вытаскивания информации с сайта 115.бел

Для доступа спользуется тот же API, который используется на самом сайтe. Описание того, что удалось вытащить из кода сайта — api.txt

В каталоге geojson — вытащенные по запросу getlist данные (запрос используется для показа точек на карте), плюс детальная информация о заявках.

В geojson/raw — заявки, вытащенные путём перебора id, включая "архивные".

Для запуска требуются gem-ы rest-client, json, nokogiri, parallel

Использование скрипта:

    # Забрать все заявки за октябрь 2018-го
    $ ./115.rb getlist 2018-10 > 2018-10.json

    # Забрать все заявки за октябрь 2018-го для Витебска
    $ ./115.rb --city 2 getlist 2018-10 > 2018-10.json

    # То же, в формате GeoJSON
    $ ./115.rb getlist --geojson 2018-10 > 2018-10.geojson

    # Забрать все заявки за февраль 2016-го и для каждой заявки получить описание и ответы
    # (Работает медленно!!!)
    $ ./115.rb getlist --geojson --deep 2016-02 > 2016-02-details.geojson

    # Получить детальную информацию по заявке
    # problem id — не номер заявки, а ID из URL страницы заявки (они разные!), или из списка, полученного по getlist
    $ ./115.rb problem <problem id>

    # Получить детальную информацию о всех заявках с ID от 0 до 1000 в формате geojson
    $ ./115.rb problem --geojson `seq 0 1000`

Для того, чтобы склеить несколько .geojson файлов, есть скрипт geojson\_merge.rb:

    $ ./geojson_merge.rb geojson/raw/*.geojson > 115-all.geojson

## Известные проблемы

1. Запрос getlist не отдаёт данные по некоторым месяцам (см. файлы в каталоге geojson). На оригинальном сайте запрос по этим месяцам сделать нельзя. Эта информация может быть вытащена перебором по номерам (команда problem).

## Полезные ссылки

https://github.com/opendataby/115 — парсинг данных 115.бел сообществом OpenData

## Лицензия
GPLv3
